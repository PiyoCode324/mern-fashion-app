// models/User.js
const mongoose = require("mongoose");

// ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’ä¿å­˜ã™ã‚‹ãŸã‚ã®ã‚¹ã‚­ãƒ¼ãƒï¼ˆè¨­è¨ˆå›³ï¼‰
const userSchema = new mongoose.Schema(
  {
    uid: {
      // Firebase Authentication ãŒç™ºè¡Œã™ã‚‹ä¸€æ„ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ID
      type: String,
      required: true,
      unique: true, // é‡è¤‡ç™»éŒ²ã‚’é˜²ã
      trim: true,   // å‰å¾Œã®ç©ºç™½ã‚’å‰Šé™¤
    },
    name: {
      // ãƒ¦ãƒ¼ã‚¶ãƒ¼åï¼ˆä»»æ„ã€ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»é¢ãªã©ã§ä½¿ç”¨ï¼‰
      type: String,
      trim: true,
    },
    email: {
      // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆãƒ­ã‚°ã‚¤ãƒ³ã«ä½¿ç”¨ï¼‰
      type: String,
      required: true,
      unique: true,             // åŒã˜ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®é‡è¤‡ç™»éŒ²ã‚’é˜²æ­¢
      trim: true,               // å‰å¾Œã®ç©ºç™½ã‚’å‰Šé™¤
      lowercase: true,          // è‡ªå‹•çš„ã«å°æ–‡å­—åŒ–
      match: [/.+@.+\..+/, "æœ‰åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"], // ãƒ¡ãƒ¼ãƒ«å½¢å¼ã®æ¤œè¨¼
      index: true,              // æ¤œç´¢æ€§èƒ½ã‚’å‘ä¸Šã•ã›ã‚‹ãŸã‚ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’ä½œæˆ
    },
    // â­ ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ¨©é™ç®¡ç†ç”¨ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
    role: {
      // 'user': ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€'admin': ç®¡ç†è€…
      type: String,
      enum: ["user", "admin"],  // è¨±å¯ã•ã‚ŒãŸå€¤ã®ã¿
      default: "user",          // ç™»éŒ²æ™‚ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæ¨©é™
    },
  },
  {
    // createdAt / updatedAt ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è‡ªå‹•è¿½åŠ 
    timestamps: true,
  }
);

// ğŸ“¦ ã‚¢ãƒ—ãƒªå…¨ä½“ã§ä½¿ç”¨ã™ã‚‹ãŸã‚ã«ãƒ¢ãƒ‡ãƒ«ã¨ã—ã¦ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
module.exports = mongoose.model("User", userSchema);
