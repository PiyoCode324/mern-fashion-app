// middleware/adminCheck.js

// ğŸ”’ ã“ã®ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã¯ç®¡ç†è€…ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ãŒã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†åˆ¶é™ã‚’ã‹ã‘ã‚‹å½¹å‰²ã‚’æŒã¤
//     - åˆ©ç”¨ã™ã‚‹éš›ã¯å¿…ãšèªè¨¼å‡¦ç†ã®å¾Œã«ä½¿ç”¨ã™ã‚‹ã“ã¨
//     - ãã®ç†ç”±ã¯ã€req.user ã«ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æƒ…å ±ãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚‹ãŸã‚

const adminCheck = (req, res, next) => {
  const user = req.user; // ğŸ” èªè¨¼å‡¦ç†å¾Œã«æ ¼ç´ã•ã‚ŒãŸãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å–å¾—

  // âœ… ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ãŒå­˜åœ¨ã—ãªã„ï¼ˆæœªãƒ­ã‚°ã‚¤ãƒ³ï¼‰ã®å ´åˆ â†’ 401 Unauthorized ã‚’è¿”ã™
  if (!user) {
    return res.status(401).json({ message: "Unauthorized" });
  }

  // âŒ ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç®¡ç†è€…ã§ãªã„å ´åˆ â†’ 403 Forbidden ã‚’è¿”ã™
  if (user.role !== "admin") {
    return res
      .status(403)
      .json({ message: "Forbidden: Admin access required" });
  }

  // ğŸ‘ ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç®¡ç†è€…ã®å ´åˆ â†’ æ¬¡ã®ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã¾ãŸã¯ãƒ«ãƒ¼ãƒˆå‡¦ç†ã¸é€²ã‚€
  next();
};

// ğŸ“¦ ã“ã®ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã‚’ä»–ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰åˆ©ç”¨ã§ãã‚‹ã‚ˆã†ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
module.exports = adminCheck;
